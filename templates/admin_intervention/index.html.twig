{% extends 'admin/index.html.twig' %}

{% block title %}Listes des Interventions |
	{{parent()}}
{% endblock %}

{% block body %}
	<div class="container">
		<div class="row">
			<div class="col">
				<h2 class="text-right ml-3 text-white">Liste des Interventions</h2>
				<a class="btn btn-primary my-4 m-md-0" href="{{path('app_admin_planning')}}" role="button">
					<i class="bi bi-arrow-left"></i>
					Retour au planning
				</a>

				<div class="py-2 py-md-5 my-auto h-100">
					<div class="row d-flex justify-content-center align-items-center h-100">
						<div class="col col-lg-12 mb-4">
							<div class="shadow mb-3">

								<div class="card bg-white">

									<div>
										<div class="card d-flex flex-row justify-content-around text-center">
											<div class="col my-2">
												<strong>Entreprise</strong>
											</div>
											<div class="col d-none d-md-none d-lg-inline my-2">
												<strong>Sujet</strong>
											</div>
											<div class="col d-none d-lg-inline my-2">
												<strong>Date de DÃ©but</strong>
											</div>
											<div class="col d-none d-lg-inline my-2">
												<strong>Date de fin</strong>
											</div>
											<div class="col my-2">
												<strong>Action</strong>
											</div>
										</div>
										{% set i = 1 %}
										{% for intervention in interventions %}

											{% if i == 0 %}
												<div class="card d-flex flex-row justify-content-around mx-auto text-center">
													<div class="col my-2">
														<p class="card-text">
															{% set i = 0 %}
															{% for user in intervention.users %}
																{% if intervention.users|length > 2 %}
																	{% if i == 0 %}
																		{{user.entreprise}}
																		et d'autres..
																		{% set i = 1 %}
																	{% endif %}
																{% else %}
																	{% if loop.index == 1 %}
																		{{user.entreprise}}
																	{% elseif intervention.users|length > 2 %}
																		-
																		{{user.entreprise}}
																	{% endif %}

																{% endif %}

															{% endfor %}
														</p>
													</p>
												</div>
												<div class="col d-none d-lg-inline my-2">
													<p class="card-text">{{intervention.sujet[:10]}}</p>
												</div>
												<div class="col d-none d-lg-inline my-2">
													<p class="card-text">
														{{intervention.dateDebut|date('d/m/Y - H:i')}}
													</p>
												</div>
												<div class="col d-none d-lg-inline my-2">
													<p class="card-text">
														{{intervention.dateFin|date('d/m/Y - H:i')}}
													</p>
												</div>
												<div class="col d-flex justify-content-around my-2">
													<div>
														<a class="badge bg-success text-white" href="{{path('app_admin_intervention', {'id':intervention.id})}}">Voir</a>
													</div>
												</div>
											</div>
											{% set i = 1 %}
										{% else %}
											<div class="card d-flex flex-row justify-content-around mx-auto text-center bg-light">
												<div class="col my-2">
													<p class="card-text">
														{% for user in intervention.users %}
															{% if loop.index == 1 %}
																{{user.entreprise}}

															{% else %}
																-
																{{user.entreprise}}
															{% endif %}


														{% endfor %}
													</p>
												</div>
												<div class="col d-none d-lg-inline my-2">
													<p class="card-text">{{intervention.sujet}}</p>
												</div>
												<div class="col d-none d-lg-inline my-2">
													<p class="card-text">
														{{intervention.dateDebut|date('d/m/Y - H:i')}}
													</p>
												</div>
												<div class="col d-none d-lg-inline my-2">
													<p class="card-text">
														{{intervention.dateFin|date('d/m/Y - H:i')}}
													</p>
												</div>
												<div class="col d-flex justify-content-around my-2">
													<div>
														<a class="badge bg-success text-white" href="{{path('app_admin_intervention', {'id':intervention.id})}}">Voir</a>
													</div>
												</div>
											</div>
											{% set i = 0 %}
										{% endif %}


									{% endfor %}

									<div class="card justify-content-around text-center" style="height:42px"></div>
								</div>
							</div>
						</div>
					</div>

				{% endblock %}
